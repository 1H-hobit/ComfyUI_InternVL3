{"id":"703bdc5a-9779-4c23-8b68-df1c3e21bd2c","revision":0,"last_node_id":111,"last_link_id":148,"nodes":[{"id":36,"type":"DynamicPreprocess","pos":[-4613.9345703125,3349.370849609375],"size":[270,130],"flags":{},"order":13,"mode":0,"inputs":[{"label":"image","localized_name":"image","name":"image","type":"IMAGE","link":87},{"label":"min_num","localized_name":"min_num","name":"min_num","shape":7,"type":"INT","widget":{"name":"min_num"},"link":null},{"label":"max_num","localized_name":"max_num","name":"max_num","shape":7,"type":"INT","widget":{"name":"max_num"},"link":null},{"label":"image_size","localized_name":"image_size","name":"image_size","shape":7,"type":"INT","widget":{"name":"image_size"},"link":null},{"label":"use_thumbnail","localized_name":"use_thumbnail","name":"use_thumbnail","shape":7,"type":"BOOLEAN","widget":{"name":"use_thumbnail"},"link":null}],"outputs":[{"label":"image","localized_name":"image","name":"image","type":"IMAGE","links":[100]}],"properties":{"aux_id":"1H-hobit/ComfyUI_InternVL3","ver":"41049faad0d7f0cb70c645521794a4f105b7c125","Node name for S&R":"DynamicPreprocess","widget_ue_connectable":{}},"widgets_values":[1,12,448,true]},{"id":66,"type":"ShowText|pysssss","pos":[-3516.20849609375,4047.2822265625],"size":[279.12286376953125,271.0000915527344],"flags":{},"order":24,"mode":0,"inputs":[{"localized_name":"text","name":"text","type":"STRING","link":111}],"outputs":[{"label":"字符串","localized_name":"字符串","name":"STRING","shape":6,"type":"STRING","links":[115]}],"properties":{"cnr_id":"comfyui-custom-scripts","ver":"1.2.5","Node name for S&R":"ShowText|pysssss","widget_ue_connectable":{}},"widgets_values":["这是一盏金色吊灯，顶部呈圆形，有多个黑色细绳从顶部垂下，连接着一个装饰性的金色环形结构。环形结构下方悬挂着三个金色的圆形装饰物，每个装饰物上都有一个金色的蝴蝶形状的装饰品。"]},{"id":73,"type":"ShowText|pysssss","pos":[-3460.68994140625,2644.80078125],"size":[330,300],"flags":{},"order":29,"mode":2,"inputs":[{"localized_name":"text","name":"text","type":"STRING","link":121}],"outputs":[{"label":"字符串","localized_name":"字符串","name":"STRING","shape":6,"type":"STRING","links":null}],"properties":{"cnr_id":"comfyui-custom-scripts","ver":"1.2.5","Node name for S&R":"ShowText|pysssss","widget_ue_connectable":{}},"widgets_values":[]},{"id":6,"type":"Evaluate Strings","pos":[-2899.241455078125,3608.777587890625],"size":[315,154],"flags":{},"order":28,"mode":0,"inputs":[{"localized_name":"Python表达式","name":"python_expression","type":"STRING","widget":{"name":"python_expression"},"link":null},{"localized_name":"输出至控制台","name":"print_to_console","type":"COMBO","widget":{"name":"print_to_console"},"link":null},{"localized_name":"a","name":"a","shape":7,"type":"STRING","widget":{"name":"a"},"link":103},{"localized_name":"b","name":"b","shape":7,"type":"STRING","widget":{"name":"b"},"link":104},{"localized_name":"c","name":"c","shape":7,"type":"STRING","widget":{"name":"c"},"link":115}],"outputs":[{"label":"字符串","localized_name":"字符串","name":"STRING","type":"STRING","links":[117]}],"properties":{"cnr_id":"efficiency-nodes-comfyui","ver":"3ead4afd120833f3bffdefeca0d6545df8051798","Node name for S&R":"Evaluate Strings","widget_ue_connectable":{"a":true,"b":true,"c":true}},"widgets_values":["a + b + c","False","Hello"," World","!"],"color":"#2a363b","bgcolor":"#3f5159","shape":1},{"id":84,"type":"ShowText|pysssss","pos":[-3462.282470703125,1901.2188720703125],"size":[330,300],"flags":{},"order":30,"mode":2,"inputs":[{"localized_name":"text","name":"text","type":"STRING","link":134}],"outputs":[{"label":"字符串","localized_name":"字符串","name":"STRING","shape":6,"type":"STRING","links":null}],"properties":{"cnr_id":"comfyui-custom-scripts","ver":"1.2.5","Node name for S&R":"ShowText|pysssss","widget_ue_connectable":{}},"widgets_values":[]},{"id":13,"type":"ShowText|pysssss","pos":[-3510.48486328125,3329.4716796875],"size":[279.12286376953125,271.0000915527344],"flags":{},"order":23,"mode":0,"inputs":[{"localized_name":"text","name":"text","type":"STRING","link":98}],"outputs":[{"label":"字符串","localized_name":"字符串","name":"STRING","shape":6,"type":"STRING","links":[103]}],"properties":{"cnr_id":"comfyui-custom-scripts","ver":"1.2.5","Node name for S&R":"ShowText|pysssss","widget_ue_connectable":{}},"widgets_values":["这张图片展示了一个温馨的室内场景。在图片的中央上方，有一个吊灯，灯罩呈棕色，灯泡发出柔和的黄色光芒。吊灯下方是一张木质的抽屉柜，柜子上放着一本打开的书和一个透明的玻璃花瓶，花瓶里插着几朵橙色的花。在抽屉柜的右侧，有一个点燃的蜡烛，蜡烛的火焰微微摇曳。在图片的左侧墙上，挂着一幅画，画中描绘了一位坐在桌前的女性，桌上摆放着一些物品。整个场景显得非常宁静和舒适。"]},{"id":59,"type":"CR Text","pos":[-3558.12451171875,3710.237060546875],"size":[400,200],"flags":{},"order":0,"mode":0,"inputs":[{"localized_name":"文本","name":"text","type":"STRING","widget":{"name":"text"},"link":null}],"outputs":[{"label":"文本","localized_name":"text","name":"text","type":"*","links":[104]},{"label":"显示帮助","localized_name":"show_help","name":"show_help","type":"STRING","links":null}],"properties":{"aux_id":"RockOfFire/ComfyUI_Comfyroll_CustomNodes","ver":"d78b780ae43fcf8c6b7c6505e6ffb4584281ceca","Node name for S&R":"CR Text","widget_ue_connectable":{}},"widgets_values":["据上述文本内容，保留主体描述，并根据以下相关描述重写上述文本内容：",[false,true]]},{"id":12,"type":"LoadImage","pos":[-5046.52587890625,3425.115234375],"size":[270,314],"flags":{},"order":1,"mode":0,"inputs":[{"localized_name":"图像","name":"image","type":"COMBO","widget":{"name":"image"},"link":null},{"localized_name":"选择文件上传","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"label":"图像","localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[87]},{"label":"遮罩","localized_name":"遮罩","name":"MASK","type":"MASK","links":null}],"properties":{"cnr_id":"comfy-core","ver":"0.3.43","Node name for S&R":"LoadImage","widget_ue_connectable":{}},"widgets_values":["pasted/image (20).png","image"]},{"id":60,"type":"LoadImage","pos":[-5043.2041015625,3987.493408203125],"size":[270,314.000244140625],"flags":{},"order":2,"mode":0,"inputs":[{"localized_name":"图像","name":"image","type":"COMBO","widget":{"name":"image"},"link":null},{"localized_name":"选择文件上传","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"label":"图像","localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[114]},{"label":"遮罩","localized_name":"遮罩","name":"MASK","type":"MASK","links":null}],"properties":{"cnr_id":"comfy-core","ver":"0.3.43","Node name for S&R":"LoadImage","widget_ue_connectable":{}},"widgets_values":["pasted/image (21).png","image"]},{"id":10,"type":"ShowText|pysssss","pos":[-2487.0751953125,3608.203125],"size":[408.8555603027344,256.053466796875],"flags":{},"order":31,"mode":0,"inputs":[{"localized_name":"text","name":"text","type":"STRING","link":117}],"outputs":[{"label":"字符串","localized_name":"字符串","name":"STRING","shape":6,"type":"STRING","links":null}],"properties":{"cnr_id":"comfyui-custom-scripts","ver":"1.2.5","Node name for S&R":"ShowText|pysssss","widget_ue_connectable":{}},"widgets_values":["这张图片展示了一个温馨的室内场景。在图片的中央上方，有一个吊灯，灯罩呈棕色，灯泡发出柔和的黄色光芒。吊灯下方是一张木质的抽屉柜，柜子上放着一本打开的书和一个透明的玻璃花瓶，花瓶里插着几朵橙色的花。在抽屉柜的右侧，有一个点燃的蜡烛，蜡烛的火焰微微摇曳。在图片的左侧墙上，挂着一幅画，画中描绘了一位坐在桌前的女性，桌上摆放着一些物品。整个场景显得非常宁静和舒适。据上述文本内容，保留主体描述，并根据以下相关描述重写上述文本内容：这是一盏金色吊灯，顶部呈圆形，有多个黑色细绳从顶部垂下，连接着一个装饰性的金色环形结构。环形结构下方悬挂着三个金色的圆形装饰物，每个装饰物上都有一个金色的蝴蝶形状的装饰品。"]},{"id":79,"type":"ShowText|pysssss","pos":[-3896.590087890625,1231.7315673828125],"size":[279.12286376953125,271.0000915527344],"flags":{},"order":25,"mode":2,"inputs":[{"localized_name":"text","name":"text","type":"STRING","link":146}],"outputs":[{"label":"字符串","localized_name":"字符串","name":"STRING","shape":6,"type":"STRING","links":[]}],"properties":{"cnr_id":"comfyui-custom-scripts","ver":"1.2.5","Node name for S&R":"ShowText|pysssss","widget_ue_connectable":{}},"widgets_values":["图片中有一个金色吊灯，顶部是圆形的装饰盘，盘子下方悬挂着三个金色的环形装饰物，每个环形装饰物上都有一个蝴蝶形状的装饰。"]},{"id":83,"type":"LoadImage","pos":[-5105.4423828125,1241.388427734375],"size":[270,314],"flags":{},"order":3,"mode":2,"inputs":[{"localized_name":"图像","name":"image","type":"COMBO","widget":{"name":"image"},"link":null},{"localized_name":"选择文件上传","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"label":"图像","localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[131]},{"label":"遮罩","localized_name":"遮罩","name":"MASK","type":"MASK","links":null}],"properties":{"cnr_id":"comfy-core","ver":"0.3.43","Node name for S&R":"LoadImage","widget_ue_connectable":{}},"widgets_values":["主图组件-3 (6).jpg","image"]},{"id":96,"type":"InternVLHFInference","pos":[-4813.26123046875,1924.778076171875],"size":[400,258],"flags":{},"order":17,"mode":2,"inputs":[{"label":"image","localized_name":"image","name":"image","shape":7,"type":"IMAGE","link":null},{"label":"model","localized_name":"model","name":"model","shape":7,"type":"InternVLModel","link":141},{"label":"system_prompt","localized_name":"system_prompt","name":"system_prompt","type":"STRING","widget":{"name":"system_prompt"},"link":null},{"label":"prompt","localized_name":"prompt","name":"prompt","type":"STRING","widget":{"name":"prompt"},"link":null},{"label":"video_path","localized_name":"video_path","name":"video_path","shape":7,"type":"STRING","widget":{"name":"video_path"},"link":142},{"label":"keep_model_loaded","localized_name":"keep_model_loaded","name":"keep_model_loaded","shape":7,"type":"BOOLEAN","widget":{"name":"keep_model_loaded"},"link":null},{"label":"max_new_tokens","localized_name":"max_new_tokens","name":"max_new_tokens","shape":7,"type":"INT","widget":{"name":"max_new_tokens"},"link":null},{"label":"do_sample","localized_name":"do_sample","name":"do_sample","shape":7,"type":"BOOLEAN","widget":{"name":"do_sample"},"link":null}],"outputs":[{"label":"output","localized_name":"output","name":"output","type":"STRING","links":[140]}],"properties":{"aux_id":"1H-hobit/ComfyUI_InternVL3","ver":"ea83fdaeaf1eaec63ab9755334720a9ee368d05f","Node name for S&R":"InternVLHFInference","widget_ue_connectable":{}},"widgets_values":["","请详细描述视频？","",true,1024,false,[false,true],[false,true]]},{"id":88,"type":"ShowText|pysssss","pos":[-4381.93017578125,1913.5780029296875],"size":[330,300],"flags":{},"order":22,"mode":2,"inputs":[{"localized_name":"text","name":"text","type":"STRING","link":140}],"outputs":[{"label":"字符串","localized_name":"字符串","name":"STRING","shape":6,"type":"STRING","links":[136]}],"properties":{"cnr_id":"comfyui-custom-scripts","ver":"1.2.5","Node name for S&R":"ShowText|pysssss","widget_ue_connectable":{}},"widgets_values":[]},{"id":85,"type":"InternVLModelLoader","pos":[-5171.267578125,1933.087890625],"size":[320.91070556640625,106],"flags":{},"order":4,"mode":2,"inputs":[{"label":"model","localized_name":"model","name":"model","type":"COMBO","widget":{"name":"model"},"link":null},{"label":"quantized","localized_name":"quantized","name":"quantized","type":"COMBO","widget":{"name":"quantized"},"link":null}],"outputs":[{"label":"intervl_model","localized_name":"intervl_model","name":"intervl_model","type":"InternVLModel","links":[141]}],"properties":{"aux_id":"1H-hobit/ComfyUI_InternVL3","ver":"41049faad0d7f0cb70c645521794a4f105b7c125","Node name for S&R":"InternVLModelLoader","widget_ue_connectable":{}},"widgets_values":["OpenGVLab/InternVL3-14B-Instruct","load_in_4bit","delete_model"]},{"id":77,"type":"ShowText|pysssss","pos":[-4364.30224609375,2648.412109375],"size":[330,300],"flags":{},"order":21,"mode":2,"inputs":[{"localized_name":"text","name":"text","type":"STRING","link":143}],"outputs":[{"label":"字符串","localized_name":"字符串","name":"STRING","shape":6,"type":"STRING","links":[128]}],"properties":{"cnr_id":"comfyui-custom-scripts","ver":"1.2.5","Node name for S&R":"ShowText|pysssss","widget_ue_connectable":{}},"widgets_values":[]},{"id":81,"type":"InternVLModelLoader","pos":[-4742.43505859375,1440.9949951171875],"size":[317.1219482421875,106],"flags":{},"order":5,"mode":2,"inputs":[{"label":"model","localized_name":"model","name":"model","type":"COMBO","widget":{"name":"model"},"link":null},{"label":"quantized","localized_name":"quantized","name":"quantized","type":"COMBO","widget":{"name":"quantized"},"link":null}],"outputs":[{"label":"intervl_model","localized_name":"intervl_model","name":"intervl_model","type":"InternVLModel","links":[147]}],"properties":{"aux_id":"1H-hobit/ComfyUI_InternVL3","ver":"41049faad0d7f0cb70c645521794a4f105b7c125","Node name for S&R":"InternVLModelLoader","widget_ue_connectable":{}},"widgets_values":["OpenGVLab/InternVL3-14B-Instruct","load_in_4bit","delete_model"]},{"id":80,"type":"DynamicPreprocess","pos":[-4741.443359375,1239.5478515625],"size":[270,130],"flags":{},"order":15,"mode":2,"inputs":[{"label":"image","localized_name":"image","name":"image","type":"IMAGE","link":131},{"label":"min_num","localized_name":"min_num","name":"min_num","shape":7,"type":"INT","widget":{"name":"min_num"},"link":null},{"label":"max_num","localized_name":"max_num","name":"max_num","shape":7,"type":"INT","widget":{"name":"max_num"},"link":null},{"label":"image_size","localized_name":"image_size","name":"image_size","shape":7,"type":"INT","widget":{"name":"image_size"},"link":null},{"label":"use_thumbnail","localized_name":"use_thumbnail","name":"use_thumbnail","shape":7,"type":"BOOLEAN","widget":{"name":"use_thumbnail"},"link":null}],"outputs":[{"label":"image","localized_name":"image","name":"image","type":"IMAGE","links":[145]}],"properties":{"aux_id":"1H-hobit/ComfyUI_InternVL3","ver":"41049faad0d7f0cb70c645521794a4f105b7c125","Node name for S&R":"DynamicPreprocess","widget_ue_connectable":{}},"widgets_values":[1,12,448,true]},{"id":98,"type":"InternVLHFInference","pos":[-4349.15283203125,1244.329833984375],"size":[400,258],"flags":{},"order":20,"mode":2,"inputs":[{"label":"image","localized_name":"image","name":"image","shape":7,"type":"IMAGE","link":145},{"label":"model","localized_name":"model","name":"model","shape":7,"type":"InternVLModel","link":147},{"label":"system_prompt","localized_name":"system_prompt","name":"system_prompt","type":"STRING","widget":{"name":"system_prompt"},"link":null},{"label":"prompt","localized_name":"prompt","name":"prompt","type":"STRING","widget":{"name":"prompt"},"link":null},{"label":"video_path","localized_name":"video_path","name":"video_path","shape":7,"type":"STRING","widget":{"name":"video_path"},"link":null},{"label":"keep_model_loaded","localized_name":"keep_model_loaded","name":"keep_model_loaded","shape":7,"type":"BOOLEAN","widget":{"name":"keep_model_loaded"},"link":null},{"label":"max_new_tokens","localized_name":"max_new_tokens","name":"max_new_tokens","shape":7,"type":"INT","widget":{"name":"max_new_tokens"},"link":null},{"label":"do_sample","localized_name":"do_sample","name":"do_sample","shape":7,"type":"BOOLEAN","widget":{"name":"do_sample"},"link":null}],"outputs":[{"label":"output","localized_name":"output","name":"output","type":"STRING","links":[146]}],"properties":{"aux_id":"1H-hobit/ComfyUI_InternVL3","ver":"ea83fdaeaf1eaec63ab9755334720a9ee368d05f","Node name for S&R":"InternVLHFInference","widget_ue_connectable":{}},"widgets_values":["详细描述不要包含任何Markdown格式的图片标记，不需要图片缩略图片回复，直接输出文字描述内容。","请用一段自然语言的句子详细描述图片，所有物品需要明确数量，并说明相关场景元素位于场景图片的那个方位。","",true,1024,false,[false,true],[false,true]]},{"id":75,"type":"InternVLModelLoader","pos":[-5182.07421875,2707.218505859375],"size":[320.91070556640625,106],"flags":{},"order":6,"mode":2,"inputs":[{"label":"model","localized_name":"model","name":"model","type":"COMBO","widget":{"name":"model"},"link":null},{"label":"quantized","localized_name":"quantized","name":"quantized","type":"COMBO","widget":{"name":"quantized"},"link":null}],"outputs":[{"label":"intervl_model","localized_name":"intervl_model","name":"intervl_model","type":"InternVLModel","links":[144]}],"properties":{"aux_id":"1H-hobit/ComfyUI_InternVL3","ver":"41049faad0d7f0cb70c645521794a4f105b7c125","Node name for S&R":"InternVLModelLoader","widget_ue_connectable":{}},"widgets_values":["OpenGVLab/InternVL3-14B-Instruct","load_in_4bit","delete_model"]},{"id":110,"type":"Fast Groups Muter (rgthree)","pos":[-5493.8544921875,2521.401123046875],"size":[210,418],"flags":{},"order":7,"mode":0,"inputs":[],"outputs":[{"label":"可选连接","name":"OPT_CONNECTION","type":"*","links":null}],"properties":{"matchColors":"","matchTitle":"FLUX.1 Kontext 提示词生成器","showNav":true,"sort":"position","customSortAlphabet":"","toggleRestriction":"default","widget_ue_connectable":{}}},{"id":93,"type":"VideoBasicLoadVideo","pos":[-5893.37548828125,1787.054931640625],"size":[401.3966064453125,607.8347778320312],"flags":{},"order":8,"mode":0,"inputs":[{"label":"video","localized_name":"video","name":"video","type":"COMBO","widget":{"name":"video"},"link":null}],"outputs":[{"label":"file_path","localized_name":"file_path","name":"file_path","type":"STRING","links":[142]}],"properties":{"aux_id":"jax-explorer/ComfyUI-VideoBasic","ver":"fc1c673c75db4087d5f2e6f70155c989d2b08011","Node name for S&R":"VideoBasicLoadVideo","widget_ue_connectable":{}},"widgets_values":{"video":"AnimateDiff_00050.mp4","choose video to upload":"image","videopreview":{"hidden":false,"paused":false,"params":{"filename":"AnimateDiff_00050.mp4","type":"input","format":"video/mp4"}}}},{"id":109,"type":"Fast Groups Muter (rgthree)","pos":[-5453.59521484375,1781.779052734375],"size":[210,418],"flags":{},"order":9,"mode":0,"inputs":[],"outputs":[{"label":"可选连接","name":"OPT_CONNECTION","type":"*","links":null}],"properties":{"matchColors":"","matchTitle":"视频描述","showNav":true,"sort":"position","customSortAlphabet":"","toggleRestriction":"default","widget_ue_connectable":{}}},{"id":108,"type":"Fast Groups Muter (rgthree)","pos":[-5419.29833984375,1165.976806640625],"size":[210,418],"flags":{},"order":10,"mode":0,"inputs":[],"outputs":[{"label":"可选连接","name":"OPT_CONNECTION","type":"*","links":null}],"properties":{"matchColors":"","matchTitle":"单图描述","showNav":true,"sort":"position","customSortAlphabet":"","toggleRestriction":"default","widget_ue_connectable":{}}},{"id":111,"type":"Fast Groups Muter (rgthree)","pos":[-5467.79443359375,3218.688232421875],"size":[210,418],"flags":{},"order":11,"mode":0,"inputs":[],"outputs":[{"label":"可选连接","name":"OPT_CONNECTION","type":"*","links":null}],"properties":{"matchColors":"","matchTitle":"双图重写描述","showNav":true,"sort":"position","customSortAlphabet":"","toggleRestriction":"default","widget_ue_connectable":{}}},{"id":70,"type":"DynamicPreprocess","pos":[-4666.6728515625,3996.05078125],"size":[270,130],"flags":{},"order":14,"mode":0,"inputs":[{"label":"image","localized_name":"image","name":"image","type":"IMAGE","link":114},{"label":"min_num","localized_name":"min_num","name":"min_num","shape":7,"type":"INT","widget":{"name":"min_num"},"link":null},{"label":"max_num","localized_name":"max_num","name":"max_num","shape":7,"type":"INT","widget":{"name":"max_num"},"link":null},{"label":"image_size","localized_name":"image_size","name":"image_size","shape":7,"type":"INT","widget":{"name":"image_size"},"link":null},{"label":"use_thumbnail","localized_name":"use_thumbnail","name":"use_thumbnail","shape":7,"type":"BOOLEAN","widget":{"name":"use_thumbnail"},"link":null}],"outputs":[{"label":"image","localized_name":"image","name":"image","type":"IMAGE","links":[105]}],"properties":{"aux_id":"1H-hobit/ComfyUI_InternVL3","ver":"41049faad0d7f0cb70c645521794a4f105b7c125","Node name for S&R":"DynamicPreprocess","widget_ue_connectable":{}},"widgets_values":[1,12,448,true]},{"id":69,"type":"InternVLModelLoader","pos":[-4683.115234375,3665.42041015625],"size":[319.7607727050781,106],"flags":{},"order":12,"mode":0,"inputs":[{"label":"model","localized_name":"model","name":"model","type":"COMBO","widget":{"name":"model"},"link":null},{"label":"quantized","localized_name":"quantized","name":"quantized","type":"COMBO","widget":{"name":"quantized"},"link":null}],"outputs":[{"label":"intervl_model","localized_name":"intervl_model","name":"intervl_model","type":"InternVLModel","links":[106,148]}],"properties":{"aux_id":"1H-hobit/ComfyUI_InternVL3","ver":"41049faad0d7f0cb70c645521794a4f105b7c125","Node name for S&R":"InternVLModelLoader","widget_ue_connectable":{}},"widgets_values":["OpenGVLab/InternVL3-14B-Instruct","load_in_4bit","delete_model"]},{"id":55,"type":"InternVLHFInference","pos":[-4132.1572265625,3362.983154296875],"size":[400,258],"flags":{},"order":18,"mode":0,"inputs":[{"label":"image","localized_name":"image","name":"image","shape":7,"type":"IMAGE","link":100},{"label":"model","localized_name":"model","name":"model","shape":7,"type":"InternVLModel","link":148},{"label":"system_prompt","localized_name":"system_prompt","name":"system_prompt","type":"STRING","widget":{"name":"system_prompt"},"link":null},{"label":"prompt","localized_name":"prompt","name":"prompt","type":"STRING","widget":{"name":"prompt"},"link":null},{"label":"video_path","localized_name":"video_path","name":"video_path","shape":7,"type":"STRING","widget":{"name":"video_path"},"link":null},{"label":"keep_model_loaded","localized_name":"keep_model_loaded","name":"keep_model_loaded","shape":7,"type":"BOOLEAN","widget":{"name":"keep_model_loaded"},"link":null},{"label":"max_new_tokens","localized_name":"max_new_tokens","name":"max_new_tokens","shape":7,"type":"INT","widget":{"name":"max_new_tokens"},"link":null},{"label":"do_sample","localized_name":"do_sample","name":"do_sample","shape":7,"type":"BOOLEAN","widget":{"name":"do_sample"},"link":null}],"outputs":[{"label":"output","localized_name":"output","name":"output","type":"STRING","links":[98]}],"properties":{"aux_id":"1H-hobit/ComfyUI_InternVL3","ver":"41049faad0d7f0cb70c645521794a4f105b7c125","Node name for S&R":"InternVLHFInference","widget_ue_connectable":{}},"widgets_values":["详细描述不要包含任何Markdown格式的图片标记，不需要图片缩略图片回复，直接输出文字描述内容。","请用一段自然语言的句子详细描述图片，所有物品需要明确数量，并说明相关场景元素位于场景图片的那个方位。","",1024,1024,false,[false,true],[false,true]]},{"id":61,"type":"InternVLHFInference","pos":[-4284.91552734375,4008.145263671875],"size":[400,258],"flags":{},"order":19,"mode":0,"inputs":[{"label":"image","localized_name":"image","name":"image","shape":7,"type":"IMAGE","link":105},{"label":"model","localized_name":"model","name":"model","shape":7,"type":"InternVLModel","link":106},{"label":"system_prompt","localized_name":"system_prompt","name":"system_prompt","type":"STRING","widget":{"name":"system_prompt"},"link":null},{"label":"prompt","localized_name":"prompt","name":"prompt","type":"STRING","widget":{"name":"prompt"},"link":null},{"label":"video_path","localized_name":"video_path","name":"video_path","shape":7,"type":"STRING","widget":{"name":"video_path"},"link":null},{"label":"keep_model_loaded","localized_name":"keep_model_loaded","name":"keep_model_loaded","shape":7,"type":"BOOLEAN","widget":{"name":"keep_model_loaded"},"link":null},{"label":"max_new_tokens","localized_name":"max_new_tokens","name":"max_new_tokens","shape":7,"type":"INT","widget":{"name":"max_new_tokens"},"link":null},{"label":"do_sample","localized_name":"do_sample","name":"do_sample","shape":7,"type":"BOOLEAN","widget":{"name":"do_sample"},"link":null}],"outputs":[{"label":"output","localized_name":"output","name":"output","type":"STRING","links":[111]}],"properties":{"aux_id":"1H-hobit/ComfyUI_InternVL3","ver":"41049faad0d7f0cb70c645521794a4f105b7c125","Node name for S&R":"InternVLHFInference","widget_ue_connectable":{}},"widgets_values":["详细描述不要包含任何Markdown格式的图片标记，不需要图片缩略图片回复，直接输出文字描述内容。","请用一段自然语言的句子详细描述图片，所有物品需要明确数量，并说明相关场景元素位于场景图片的那个方位。","",1024,1024,false,[false,true],[false,true]]},{"id":74,"type":"Text_Translation_V2_Full","pos":[-3957.528564453125,2652.43994140625],"size":[448.8567199707031,290.8440246582031],"flags":{},"order":26,"mode":2,"inputs":[{"label":"trans_switch","localized_name":"trans_switch","name":"trans_switch","type":"BOOLEAN","widget":{"name":"trans_switch"},"link":null},{"label":"trans_text","localized_name":"trans_text","name":"trans_text","type":"STRING","widget":{"name":"trans_text"},"link":128},{"label":"translator","localized_name":"translator","name":"translator","type":"COMBO","widget":{"name":"translator"},"link":null},{"label":"source_language","localized_name":"source_language","name":"source_language","type":"COMBO","widget":{"name":"source_language"},"link":null},{"label":"target_language","localized_name":"target_language","name":"target_language","type":"COMBO","widget":{"name":"target_language"},"link":null}],"outputs":[{"label":"string","localized_name":"string","name":"string","type":"STRING","links":[121]}],"properties":{"aux_id":"TFL-TFL/ComfyUI_Text_Translation","ver":"495f9773dd3651a366ebac664fc4b0f301e9b1b3","Node name for S&R":"Text_Translation_V2_Full","widget_ue_connectable":{}},"widgets_values":[true,"","Youdao","auto","English(en)","button_hide",[false,true]]},{"id":97,"type":"InternVLHFInference","pos":[-4825.0546875,2569.84130859375],"size":[447.8229064941406,541.1211547851562],"flags":{},"order":16,"mode":2,"inputs":[{"label":"image","localized_name":"image","name":"image","shape":7,"type":"IMAGE","link":null},{"label":"model","localized_name":"model","name":"model","shape":7,"type":"InternVLModel","link":144},{"label":"system_prompt","localized_name":"system_prompt","name":"system_prompt","type":"STRING","widget":{"name":"system_prompt"},"link":null},{"label":"prompt","localized_name":"prompt","name":"prompt","type":"STRING","widget":{"name":"prompt"},"link":null},{"label":"video_path","localized_name":"video_path","name":"video_path","shape":7,"type":"STRING","widget":{"name":"video_path"},"link":null},{"label":"keep_model_loaded","localized_name":"keep_model_loaded","name":"keep_model_loaded","shape":7,"type":"BOOLEAN","widget":{"name":"keep_model_loaded"},"link":null},{"label":"max_new_tokens","localized_name":"max_new_tokens","name":"max_new_tokens","shape":7,"type":"INT","widget":{"name":"max_new_tokens"},"link":null},{"label":"do_sample","localized_name":"do_sample","name":"do_sample","shape":7,"type":"BOOLEAN","widget":{"name":"do_sample"},"link":null}],"outputs":[{"label":"output","localized_name":"output","name":"output","type":"STRING","links":[143]}],"properties":{"aux_id":"1H-hobit/ComfyUI_InternVL3","ver":"ea83fdaeaf1eaec63ab9755334720a9ee368d05f","Node name for S&R":"InternVLHFInference","widget_ue_connectable":{}},"widgets_values":["# FLUX.1 Kontext 提示词生成助手\n \n你是一位专业的 FLUX.1 Kontext 图像编辑提示词专家。你的任务是帮助用户生成高质量、精确的 Kontext 提示词,以实现他们想要的图像编辑效果。\n \n## 欢迎信息\n \n当用户首次与你互动时,请用以下信息问候:\n \n---\n \n  **欢迎使用 FLUX.1 Kontext 提示词生成器!**\n \n我在这里帮助你为 FLUX.1 Kontext 图像编辑创建完美的提示词。我可以协助你:\n \n✨ **对象修改** (颜色、纹理、形状)\n  **风格转换** (艺术风格、滤镜、效果)  \n  **场景转换** (背景、光照、氛围)\n  **角色一致性** (在编辑过程中保持身份特征)\n  **文本编辑** (标志、标签、排版)\n \n**开始使用:**\n- 描述你想要在图像中改变什么\n- 上传图片(可选)\n- 告诉我你的编辑目标\n \n对于复杂的转换,我会提供:\n-   **一步到位方案** (单个综合提示词)\n-   **逐步方案** (多个连续提示词)\n \n所有提示词将使用**英语**生成以获得最佳 Kontext 性能。\n \n**今天想要编辑什么?**  \n \n---\n \n## 核心原则\n \n### 1. 精确优先\n- 使用具体描述而不是模糊术语\n- 明确指定颜色、风格、动作和其他细节\n- 避免主观表达如\"让它看起来更好\"\n- 记住:最大提示词限制为 512 个 token\n- **重要提示:所有提示词必须使用英语生成**\n \n### 2. 保持一致性\n- 明确指定应保持不变的元素\n- 使用\"while maintaining...\"等短语来保护重要特征\n- 避免意外改变用户不想修改的元素\n \n### 3. 逐步处理\n- 建议将复杂修改分解为多个步骤\n- 每次编辑专注于一个主要改变\n- 利用 Kontext 的迭代编辑能力\n \n## 提示词结构模板\n \n### 基本对象修改\n`Change the [specific object]'s [specific attribute] to [specific value]`\n \n示例: \"Change the car color to red\"\n \n### 风格转换\n`Convert to [specific style] while maintaining [elements to preserve]`\n \n示例: \"Convert to pencil sketch with natural graphite lines, cross-hatching, and visible paper texture\"\n \n### 背景/环境改变\n`Change the background to [new environment] while keeping the [subject] in the exact same position, scale, and pose. Maintain identical subject placement, camera angle, framing, and perspective.`\n \n### 角色一致性\n`[Action/change description] while preserving [character's] exact facial features, [specific characteristics], and [other identity markers]`\n \n### 文本编辑\n`Replace '[original text]' with '[new text]'`\n \n示例: \"Replace 'joy' with 'BFL'\"\n \n## 高级技巧\n \n### 风格转换:\n1. **指定具体风格**: 不要用\"make it artistic\",而要用\"Transform to Bauhaus art style\"\n2. **引用知名艺术家/流派**: \"Renaissance painting style,\" \"1960s pop art poster\"\n3. **详述关键特征**: \"Oil painting with visible brushstrokes, thick paint texture, and rich color depth\"\n4. **保留重要内容**: \"while maintaining the original composition and object placement\"\n \n### 角色一致性:\n1. **建立参考**: 用\"The woman with short black hair\"而不是\"her\"\n2. **指定转换**: 环境、活动或风格变化\n3. **保留身份标记**: \"maintaining the same facial features, hairstyle, and expression\"\n \n### 构图控制:\n- 使用\"exact same position, scale, and pose\"\n- 添加\"Only replace the environment around them\"\n \n## 常见问题解决模式\n \n### 当身份变化过大时:\n- 添加: \"while preserving exact facial features, eye color, and facial expression\"\n- 使用: \"Change the clothes to [description]\"而不是\"Transform the person into [description]\"\n \n### 当构图发生偏移时:\n- 添加: \"while keeping the person in the exact same position, scale, and pose\"\n- 指定: \"Maintain identical subject placement, camera angle, framing, and perspective\"\n \n### 当风格应用不正确时:\n- 更具体地描述风格特征\n- 为重要元素添加保留说明\n- 使用详细的风格描述而不是泛泛而谈\n \n## 动词选择指南\n \n- **\"Transform\"** → 暗示完全改变,谨慎使用\n- **\"Change the [specific element]\"** → 更受控的修改\n- **\"Replace the [specific element]\"** → 针对性替换\n- **\"Convert to [style]\"** → 以风格为重点的转换\n \n## 最佳实践检查清单\n \n生成提示词时,确保:\n- [ ] 使用具体而非模糊的语言\n- [ ] 为不变元素提供清晰的保留说明\n- [ ] 根据所需变化程度选择适当的动词\n- [ ] 直接命名主体而不是使用代词\n- [ ] 为要编辑的文本加上引号\n- [ ] 对复杂变化采用逐步方法\n- [ ] 必要时进行明确的构图控制\n \n## 对话流程管理\n \n### 理解用户上下文\n- 每次对话可能涉及不同的编辑请求\n- 用户可能提供参考图像或口头描述图像\n- 请求可能从简单的对象更改到复杂的场景转换\n- 如果用户意图不清晰,始终要求澄清\n \n### 处理参考图像\n当用户提供图像时:\n- 分析图像内容并识别关键元素\n- 询问具体想要改变什么\n- 确定应该保留的元素\n- 考虑图像的风格、构图和主题\n \n当用户描述图像而不提供时:\n- 询问图像内容的关键细节\n- 明确当前状态与期望状态\n- 请求关于需要保留的重要元素的信息\n \n## 响应格式\n \n当用户请求 Kontext 提示词时,提供:\n \n### 简单请求:\n1. **优化提示词**: 单个精心制作的指令\n2. **故障排除提示**: 潜在问题和解决方案\n \n### 复杂请求:\n始终提供两种版本:\n \n1. **一步到位方案**: \n   - 单个综合提示词尝试完成全部转换\n   - 警告关于复杂单步编辑的潜在问题\n   \n2. **逐步方案**: \n   - 按逻辑步骤分解的连续提示词\n   - 解释为什么推荐这种方法\n   - 清晰的编号和操作顺序\n \n3. **建议**: 解释哪种方法可能更好以及原因\n \n## 示例响应结构\n \n### 示例 1: 简单请求\n**用户请求**: \"将汽车颜色改为蓝色\"\n \n**优化提示词**: \n\"Change the car color to deep blue while maintaining the same car model, position, lighting, and background\"\n \n**故障排除**: 如果其他元素意外改变,添加\"keeping everything else exactly the same\"\n \n### 示例 2: 复杂请求\n**用户请求**: \"我想将白天的街景照片转换为赛博朋克风格的夜景,带有霓虹灯和未来元素\"\n \n**一步到位方案**: \n\"Transform the daytime street scene into a cyberpunk night environment with neon lights, holographic advertisements, futuristic architecture, and atmospheric fog, while maintaining the same camera angle, street layout, and overall composition\"\n \n*⚠️ 警告: 这种复杂的一步转换可能会改变非预期元素或丢失重要细节。*\n \n**逐步方案** (推荐):\n1. \"Change the lighting from daytime to nighttime with dark sky and street lighting\"\n2. \"Add neon signs and colorful neon lighting to buildings and storefronts\"\n3. \"Transform the architecture to have more futuristic, cyberpunk elements while keeping the street layout\"\n4. \"Add atmospheric effects like fog, light rays, and holographic advertisements\"\n \n**建议**: 强烈推荐使用逐步方案进行这种复杂转换,因为它能更好地控制每个元素并减少不必要的变化风险。\n \n### 示例 3: 带参考图像分析\n**用户请求**: *[提供公园中一位女士的图片]* \"让她看起来像在中世纪奇幻场景中\"\n \n**图像分析问题**:\n- 是否要保持她的现代服装还是改为中世纪服装?\n- 是否要保持她的确切外貌和姿势?\n- 公园场景是否要变成中世纪景观,还是只添加奇幻元素?\n \n**一步到位方案**: \n\"Transform the park setting into a medieval fantasy landscape with castles, ancient trees, and mystical atmosphere, while changing her clothing to medieval dress and maintaining her exact facial features, pose, and expression\"\n \n**逐步方案**:\n1. \"Change her modern clothing to a medieval dress while preserving her exact facial features and pose\"\n2. \"Transform the park background into a medieval landscape with ancient trees and stone pathways\"\n3. \"Add fantasy elements like a distant castle and mystical lighting atmosphere\"\n \n**建议**: 推荐使用逐步方案以确保整个转换过程中角色特征的一致性。\n \n## 自适应对话指南\n \n### 首次互动:\n- 使用上述欢迎信息问候新用户\n- 如果他们提供图像,分析并询问澄清问题\n- 如果他们描述图像,询问当前与期望状态的关键细节\n- 引导他们了解你可以提供帮助的能力\n \n### 后续互动:\n- 每个新请求都应视为新的编辑目标\n- 在相关时参考之前的对话上下文\n- 根据新请求调整复杂度评估\n- 对复杂请求始终提供两种方案\n \n### 复杂度评估标准:\n**简单请求** (单一提示词方案):\n- 单个对象/属性更改\n- 基本颜色修改\n- 简单文本替换\n- 轻微光照调整\n \n**复杂请求** (提供两种方案):\n- 多个同时更改\n- 风格转换\n- 场景/环境更改\n- 角色/身份修改\n- 需要构图控制的背景替换\n \n### 沟通风格:\n- 解释要清晰简洁\n- 使用项目符号列出多步骤说明\n- 提供潜在问题警告\n- 解释建议背后的原因\n- 必要时询问后续问题\n- **无论用户使用何种语言,始终用英语生成提示词**\n \n## 语言要求\n \n**重要**: 所有 FLUX.1 Kontext 提示词必须仅用英语编写。即使用户使用其他语言交流,始终:\n- 用用户的语言(如果与英语不同)进行解释\n- **提示词仅使用英语**\n- 清楚标明哪些部分是提示词,哪些是解释\n \n当用户使用中文时的示例格式:\n \n不要添加任何对话文本、解释或偏离内容，只输出Prompt的英文内容。\nPrompt: \"Change the car color to red while maintaining the same lighting and background\"\n直接输出Change the car color to red while maintaining the same lighting and background就可以，不需要带双引号。\n \n记住: 只要每次编辑的指令数量不太复杂,把事情说得更明确总是有帮助的。始终将用户成功置于简洁之上。","把场景的时间改成晚上时间","",true,1024,false,[false,true],[false,true]]},{"id":87,"type":"Text_Translation_V2_Full","pos":[-4000.174072265625,1903.1561279296875],"size":[448.8567199707031,290.8440246582031],"flags":{},"order":27,"mode":2,"inputs":[{"label":"trans_switch","localized_name":"trans_switch","name":"trans_switch","type":"BOOLEAN","widget":{"name":"trans_switch"},"link":null},{"label":"trans_text","localized_name":"trans_text","name":"trans_text","type":"STRING","widget":{"name":"trans_text"},"link":136},{"label":"translator","localized_name":"translator","name":"translator","type":"COMBO","widget":{"name":"translator"},"link":null},{"label":"source_language","localized_name":"source_language","name":"source_language","type":"COMBO","widget":{"name":"source_language"},"link":null},{"label":"target_language","localized_name":"target_language","name":"target_language","type":"COMBO","widget":{"name":"target_language"},"link":null}],"outputs":[{"label":"string","localized_name":"string","name":"string","type":"STRING","links":[134]}],"properties":{"aux_id":"TFL-TFL/ComfyUI_Text_Translation","ver":"495f9773dd3651a366ebac664fc4b0f301e9b1b3","Node name for S&R":"Text_Translation_V2_Full","widget_ue_connectable":{}},"widgets_values":[true,"","Youdao","auto","English(en)","button_show",[false,true]]}],"links":[[87,12,0,36,0,"IMAGE"],[98,55,0,13,0,"STRING"],[100,36,0,55,0,"IMAGE"],[103,13,0,6,2,"STRING"],[104,59,0,6,3,"STRING"],[105,70,0,61,0,"IMAGE"],[106,69,0,61,1,"InternVLModel"],[111,61,0,66,0,"STRING"],[114,60,0,70,0,"IMAGE"],[115,66,0,6,4,"STRING"],[117,6,0,10,0,"STRING"],[121,74,0,73,0,"STRING"],[128,77,0,74,1,"STRING"],[131,83,0,80,0,"IMAGE"],[134,87,0,84,0,"STRING"],[136,88,0,87,1,"STRING"],[140,96,0,88,0,"STRING"],[141,85,0,96,1,"InternVLModel"],[142,93,0,96,4,"STRING"],[143,97,0,77,0,"STRING"],[144,75,0,97,1,"InternVLModel"],[145,80,0,98,0,"IMAGE"],[146,98,0,79,0,"STRING"],[147,81,0,98,1,"InternVLModel"],[148,69,0,55,1,"InternVLModel"]],"groups":[{"id":7,"title":"FLUX.1 Kontext 提示词生成器","bounding":[-5212.1552734375,2490.701904296875,2215.83154296875,529.4776611328125],"color":"#3f789e","font_size":24,"flags":{}},{"id":8,"title":"单图描述","bounding":[-5148.029296875,1117.7095947265625,1658.9541015625,474.1961975097656],"color":"#3f789e","font_size":24,"flags":{}},{"id":9,"title":"双图重写描述","bounding":[-5226.34912109375,3179.114013671875,3233.303466796875,1183.7215576171875],"color":"#3f789e","font_size":24,"flags":{}},{"id":10,"title":"视频描述","bounding":[-5213.74755859375,1747.119873046875,2229.6298828125,652.2821044921875],"color":"#3f789e","font_size":24,"flags":{}}],"config":{},"extra":{"ue_links":[],"links_added_by_ue":[],"ds":{"scale":1.0610764609500072,"offset":[5336.98693938672,-3274.751599856473]}},"version":0.4}